<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Document</title>
</head>

<body>
  <!-- <script>
    var xhr
    if (window.XMLHttpRequest) {
      xhr = new XMLHttpRequest()
    } else {
      xhr = new ActiveXObject('Microsoft.XMLHTTP')
    }
    xhr.open('GET', 'https://www.66rpg.com/ajax/limitfree/today_free_list.json?userid=0', true)
    xhr.send()

    xhr.onreadystatechange = function () {
      if (xhr.readyState === 4 && xhr.status === 200) {
        console.log(1);
      }
    }
  </script> -->
  <script src="./js/utils.js"></script>
  <script>
    // var xhr = (function () {
    //   var o = window.XMLHttpRequest
    //     ? new XMLHttpRequest()
    //     : new ActiveXObject('Microsoft.XMLHTTP')

    //   if (!o) {
    //     throw new Error('您的浏览器不支持异步发起HTTP请求')
    //   }

    //   function _doAjax(opt) {
    //     var opt = opt || {},
    //       type = (opt.type || 'GET').toUpperCase(),
    //       async = opt.async || true,
    //       url = opt.url,
    //       data = opt.data || null,
    //       error = opt.error || function () { },
    //       success = opt.success || function () { },
    //       complete = opt.complete || function () { }

    //     if (!url) {
    //       throw new Error('您没有配置URL')
    //     }

    //     o.open(type, url, async)
    //     type === 'POST' && o.setRequestHeaders('Content-type', 'x-www-form-urlencoded')
    //     o.send(type === 'GET' ? null : formatDatas(data))

    //     o.onreadystatechange = function () {
    //       if (o.readyState === 4 && o.status === 200) {
    //         success(JSON.parse(o.responseText));
    //       }

    //       if (o.status === 404) {
    //         error()
    //       }
    //       complete()
    //     }

    //   }

    //   function formatDatas(obj) {
    //     var str = ''
    //     for (var key in obj) {
    //       str += key + '=' + obj[key] + '&'
    //     }
    //     return str.replace(/&$/, '')
    //   }

    //   return {
    //     ajax: function (opt) {
    //       _doAjax(opt)
    //     },
    //     get: function (url, callback) {
    //       _doAjax({
    //         type: 'GET',
    //         url: url,
    //         success: callback
    //       })
    //     },
    //     post: function (url, data, callback) {
    //       _doAjax({
    //         type: 'POST',
    //         url: url,
    //         data: data,
    //         success: callback
    //       })
    //     }
    //   }
    // })()

    // 调用
    tools.xhr.ajax({
      type: 'POST',
      url: 'XXX',
      data: {
        status: 1,
        flag: 2
      },
      success: function (data) {
        console.log(data);
      }
    })

    tools.xhr.post('xxx', {
      status: 1,
      flag: 2
    }, function (data) {
      console.log(data);
    })

    tools.xhr.get('xxx?status=1&flag=2', function (data) {
      console.log(data);
    })


  </script>
</body>

</html>
