<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Document</title>
</head>

<body>
  <div id="data" style="display: none">
    [{"id":"1","uname":"zs","age":"18"},{"id":"2","uname":"ls","age":"16"},{"id":"3","uname":"ww","age":"20"},{"id":"4","uname":"zl","age":"17"},{"id":"5","uname":"qu","age":"22"},{"id":"6","uname":"af","age":"15"}]
  </div>
  <div id="data2" style="display: none;">
    aldtype=16047& query=difine&keyfrom=baidu & smartresult=dict &lang=auto2zh
  </div>
  <ul>
    <li></li>
    <li></li>
    <li></li>
    <li></li>
    <li></li>
    <li></li>
  </ul>
  <script src="./js/utils.js"></script>
  <script>
    var data = JSON.parse(document.getElementById('data').innerHTML),
      data2 = document.getElementById('data2').innerText,
      oLis = document.getElementsByTagName('li')

    /*
    // 1. forEach() 遍历 循环

    // for (var i = 0; i < data.length; i++) {
    //   oLis[i].innerHTML = data[i].uname
    // }

    // data.forEach(function (elem, i, array) {
    //   oLis[i].innerHTML = elem.uname
    // })

    // Array.prototype.myForEach = function (fn) {
    //   var arr = this,
    //     len = arr.length,
    //     arg2 = arguments[1] || window

    //   for (var i = 0; i < len; i++) {
    //     fn.apply(arg2, [arr[i], i, arr])
    //   }
    // }

    // data.myForEach(function (elem, index, array) {
    //   this[index].innerHTML = elem.uname
    // }, oLis)

    */

    /*
    // 2. filter() 筛选 过滤  返回一个新数组
    // var newArr = data.filter(function (elem, index, array) {
    //   return this[index].age >= 20
    // }, data)
    // console.log(newArr)

    // Array.prototype.myFilter = function (fn) {
    //   var arr = this,
    //     len = arr.length,
    //     arg2 = arguments[1] || window,
    //     newArr = [],
    //     item

    //   for (var i = 0; i < len; i++) {
    //     item = tools.deepClone(arr[i])
    //     if (fn.apply(arg2, [arr[i], i, arr])) {
    //       newArr.push(item)
    //     }
    //   }
    //   return newArr
    // }
    // var nArr = data.myFilter(function (elem, index, array) {
    //   return this[index].age < 20
    // }, data)

    // console.log(nArr)
    */

    /*
      //3. map() 映射 如果给的条件修改了数组元素值，会影响到原数组
      // var newArr = data.map(function (elem, index, array) {
      //   elem.age = parseInt(elem.age) + 10
      //   return elem
      // })
      // console.log(newArr)
      // console.log(data) // 会修改原数组

      // 重写map() 因为使用了深拷贝，所以不会修改原数组
      // Array.prototype.myMap = function (fn) {
      //   var arr = this,
      //     len = arr.length,
      //     arg2 = arguments[1] || window,
      //     nArr = [],
      //     item

      //   for (var i = 0; i < len; i++) {
      //     item = tools.deepClone(arr[i])
      //     nArr.push(fn.apply(arg2, [item, i, arr]))
      //   }
      //   return nArr
      // }

      // var newArr = data.myMap(function (elem, index, array) {
      //   elem.age = parseInt(elem.age) + 10
      //   return elem
      // })
      // console.log(newArr)
      // console.log(data)
    */

    /*
       // 4. every()
       // var res1 = data.every(function (elem, index, arr) {
       //   return elem.age >= '18'
       // })
       // console.log(res1)
   
       // Array.prototype.myEvery = function (fn) {
       //   var arr = this,
       //     len = arr.length,
       //     arg2 = arguments[1] || window,
       //     res = true
   
       //   for (var i = 0; i < len; i++) {
       //     if (!fn.apply(arg2, [arr[i], i, arr])) {
       //       res = false
       //       break
       //     }
       //   }
       //   return res
       // }
   
       // var res1 = data.myEvery(function (elem, index, arr) {
       //   return elem.age >= '18'
       // })
       // console.log(res1)
    */

    /*
        // 5. some()
        // var res2 = data.some(function (elem, index, arr) {
        //   return elem.age >= '18'
        // })
        // console.log(res2);
    
        // Array.prototype.mySome = function (fn) {
        //   var arr = this,
        //     len = arr.length,
        //     arg2 = arguments[1] || window,
        //     res = false
    
        //   for (var i = 0; i < len; i++) {
        //     if (fn.apply(arg2, [arr[i], i, arr])) {
        //       res = true
        //       break
        //     }
        //   }
        //   return res
        // }
    
        // var res2 = data.mySome(function (elem, index, arr) {
        //   return elem.age >= '18'
        // })
        // console.log(res2);
    */

    //reduce()

    // var initialValue = []
    // var res = data.reduce(function (prev, elem, index, arr) {
    //   if (elem.age >= 18) {
    //     prev.push(elem)
    //   }
    //   return prev
    // }, initialValue)
    // console.log(res);

    // var arr2 = data2.replace(/\s+/g, '').split('&')

    // var res2 = arr2.reduce(function (prev, elem, index, arr) {
    //   var item = elem.split('=')
    //   prev[item[0]] = item[1]
    //   return prev
    // }, {})
    // console.log(res2);


    //重写 reduce()
    Array.prototype.myReduce = function (fn, initialValue) {
      var arr = this,
        len = arr.length,
        arg2 = arguments[2] || window,
        item

      for (var i = 0; i < len; i++) {
        initialValue = fn.apply(arg2, [initialValue, arr[i], i, arr])
      }
      return initialValue
    }
    // 重写 reduceRight()
    Array.prototype.myReduceRight = function (fn, initialValue) {
      var arr = this,
        len = arr.length,
        arg2 = arguments[2] || window,
        item

      for (var i = len - 1; i >= 0; i--) {
        initialValue = fn.apply(arg2, [initialValue, arr[i], i, arr])
      }
      return initialValue
    }

    var arr2 = data2.replace(/\s+/g, '').split('&')

    var res2 = arr2.myReduce(function (prev, elem, index, arr) {
      var nArr = elem.split('=')
      prev[nArr[0]] = nArr[1]
      return prev
    }, {})
    console.log(res2);

    var res3 = arr2.myReduceRight(function (prev, elem, index, arr) {
      var nArr = elem.split('=')
      prev[nArr[0]] = nArr[1]
      return prev
    }, {})
    console.log(res3);

    var res4 = data.myReduce(function (prev, elem) {
      if (elem.age >= '18') {
        prev.push(elem)
      }
      return prev
    }, [])
    console.log(res4);

    var res5 = data.myReduceRight(function (prev, elem) {
      if (elem.age >= '18') {
        prev.push(elem)
      }
      return prev
    }, [])
    console.log(res5);

  </script>
</body>

</html>
